---
description: How to use Filters in MATLAB<sup>&reg;</sup> with Plotly.
name: Filter
display_as: transforms
order: 1
permalink: matlab/filter/
thumbnail: thumbnail/filter.jpg
layout: base
language: matlab
page_type: u-guide
---

## Moving-Average Filter

A moving-average filter is a common method used for smoothing noisy data. This example uses the `filter` function to compute averages along a vector of data.

Create a 1-by-100 row vector of sinusoidal data that is corrupted by random noise.

<pre class="mcode">
t = linspace(-pi,pi,100);
rng default  %initialize random number generator
x = sin(t) + 0.25*rand(size(t));
</pre>

A moving-average filter slides a window of length windowSize along the data, computing averages of the data contained in each window. The following difference equation defines a moving-average filter of a vector x:



<div class="code_responsive">

<span><span class="MathEquation" role="math" style="font-size: 15px;"><span class="MathRoot HBox" role="img" aria-label="y leftParenthesis n rightParenthesis equals StartFraction 1 over w i n d o w S i z e EndFraction leftParenthesis x leftParenthesis n rightParenthesis plus x leftParenthesis n minus 1 rightParenthesis plus ldotp ldotp ldotp plus x leftParenthesis n minus leftParenthesis w i n d o w S i z e minus 1 rightParenthesis rightParenthesis rightParenthesis ldotp" style="display: inline-block; position: relative;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.07em;">y</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox text" style="position: relative;">n</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.277778em;">=</span><span class="MathFraction VBox" style="display: inline-block; position: relative; margin-left: 0.277778em; text-align: center; vertical-align: -11px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 0px;"><span class="MathText MathTextBox number" style="position: relative;">1</span></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="rulebox" style="display: block; border-bottom-style: solid; border-bottom-width: 1px; width: 100%; height: 0px; z-index: 1; margin-top: 0px;"></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 1px;"><span class="MathText MathTextBox text" style="position: relative;">w</span><span class="MathText MathTextBox text" style="position: relative;">i</span><span class="MathText MathTextBox text" style="position: relative;">n</span><span class="MathText MathTextBox text" style="position: relative;">d</span><span class="MathText MathTextBox text" style="position: relative;">o</span><span class="MathText MathTextBox text" style="position: relative;">w</span><span class="MathText MathTextBox text" style="position: relative;">S</span><span class="MathText MathTextBox text" style="position: relative;">i</span><span class="MathText MathTextBox text" style="position: relative;">z</span><span class="MathText MathTextBox text" style="position: relative;">e</span></span></span><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px; margin-left: 0.166667em;"><span class="MathDelimiter StretchyBox" style="display: inline-block; position: relative; text-align: center;"><span class="MathTextBox extra1" style="position: relative; display: inline-block;">(</span></span><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.05em;">x</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox text" style="position: relative;">n</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.272222em;">x</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox text" style="position: relative;">n</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">−</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.222222em;">1</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox symbol" style="position: relative;">.</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.166667em;">.</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.166667em;">.</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.166667em;">+</span><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.05em;">x</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox text" style="position: relative;">n</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">−</span><span class="MathText MathTextBox extra1" style="position: relative; margin-left: 0.222222em;">(</span><span class="MathText MathTextBox text" style="position: relative;">w</span><span class="MathText MathTextBox text" style="position: relative;">i</span><span class="MathText MathTextBox text" style="position: relative;">n</span><span class="MathText MathTextBox text" style="position: relative;">d</span><span class="MathText MathTextBox text" style="position: relative;">o</span><span class="MathText MathTextBox text" style="position: relative;">w</span><span class="MathText MathTextBox text" style="position: relative;">S</span><span class="MathText MathTextBox text" style="position: relative;">i</span><span class="MathText MathTextBox text" style="position: relative;">z</span><span class="MathText MathTextBox text" style="position: relative;">e</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">−</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.222222em;">1</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathDelimiter StretchyBox" style="display: inline-block; position: relative; text-align: center;"><span class="MathTextBox extra1" style="position: relative; display: inline-block;">)</span></span></span><span class="MathText MathTextBox symbol" style="position: relative;">.</span></span></span></span></span>

</div>



For a window size of 5, compute the numerator and denominator coefficients for the rational transfer function.

<pre class="mcode">
windowSize = 5; 
b = (1/windowSize)*ones(1,windowSize);
a = 1;
</pre>

Find the moving average of the data and plot it against the original data.

<pre class="mcode">
y = filter(b,a,x);

plot(t,x)
hold on
plot(t,y)
legend('Input Data','Filtered Data')

fig2plotly()
</pre>

{% capture plot_0_0_moving_average_filter %}
  {% raw %}
{ "data": [ { "line": { "dash": "solid", "color": "rgb(0,113.985,188.955)", "width": 0.5 }, "mode": "lines", "name": "Input Data", "type": "scatter", "xsrc": "danton267:1353:9dff9e", "x": [ -3.14159265358979, -3.07812613533545, -3.01465961708111, -2.95119309882678, -2.88772658057244, -2.8242600623181, -2.76079354406376, -2.69732702580942, -2.63386050755508, -2.57039398930074, -2.5069274710464, -2.44346095279206, -2.37999443453772, -2.31652791628338, -2.25306139802904, -2.1895948797747, -2.12612836152037, -2.06266184326603, -1.99919532501169, -1.93572880675735, -1.87226228850301, -1.80879577024867, -1.74532925199433, -1.68186273373999, -1.61839621548565, -1.55492969723131, -1.49146317897697, -1.42799666072263, -1.36453014246829, -1.30106362421395, -1.23759710595962, -1.17413058770528, -1.11066406945094, -1.0471975511966, -0.983731032942258, -0.920264514687919, -0.85679799643358, -0.793331478179241, -0.729864959924901, -0.666398441670562, -0.602931923416223, -0.539465405161884, -0.475998886907544, -0.412532368653205, -0.349065850398866, -0.285599332144527, -0.222132813890187, -0.158666295635848, -0.0951997773815089, -0.0317332591271696, 0.0317332591271696, 0.0951997773815089, 0.158666295635848, 0.222132813890187, 0.285599332144527, 0.349065850398866, 0.412532368653205, 0.475998886907544, 0.539465405161884, 0.602931923416223, 0.666398441670562, 0.729864959924901, 0.793331478179241, 0.85679799643358, 0.920264514687919, 0.983731032942258, 1.0471975511966, 1.11066406945094, 1.17413058770528, 1.23759710595962, 1.30106362421395, 1.36453014246829, 1.42799666072263, 1.49146317897697, 1.55492969723131, 1.61839621548565, 1.68186273373999, 1.74532925199433, 1.80879577024867, 1.87226228850301, 1.93572880675735, 1.99919532501169, 2.06266184326603, 2.12612836152037, 2.1895948797747, 2.25306139802904, 2.31652791628338, 2.37999443453772, 2.44346095279206, 2.5069274710464, 2.57039398930074, 2.63386050755508, 2.69732702580942, 2.76079354406376, 2.8242600623181, 2.88772658057244, 2.95119309882678, 3.01465961708111, 3.07812613533545, 3.14159265358979 ], "ysrc": "danton267:1353:de948e", "y": [ 0.203680921598295, 0.16302406461234, -0.0948457495003729, 0.0390927196743448, -0.0930581756247269, -0.287648344448635, -0.302037900943565, -0.293074532287925, -0.246820027241894, -0.299418683655778, -0.553504658635253, -0.400139414246386, -0.450787274421376, -0.613247796476823, -0.576076347069557, -0.779104367393532, -0.744285109292946, -0.652519482150315, -0.71158016296463, -0.694274753666881, -0.790967066654927, -0.962883648679994, -0.772525426545014, -0.760340152521866, -0.829183550468565, -0.810439095029292, -0.811071658920713, -0.891764686997391, -0.81493297367039, -0.921045486607052, -0.768489296709766, -0.914396082510226, -0.826763028051113, -0.85448255612665, -0.808286909325809, -0.589897383449009, -0.582042418610304, -0.633419301363648, -0.429213488306703, -0.609547466094878, -0.457373773948671, -0.418287777300154, -0.26684732469016, -0.202130560122348, -0.295301992187074, -0.159291457894372, -0.108913982608816, 0.00357685655446627, 0.0822851644103355, 0.156943736997523, 0.100734202747712, 0.264981712517601, 0.32177589696681, 0.260963466585198, 0.311481977231024, 0.466611156321204, 0.640866525035634, 0.543322953393944, 0.659994329318351, 0.623012848735555, 0.805975751047018, 0.730542779381109, 0.839183434295149, 0.93051875501843, 1.01848765366478, 1.07239271093613, 1.00282928627539, 0.930649884998506, 0.959677795494346, 1.0093778822456, 1.17402147255586, 1.04237299095766, 1.19339264839814, 1.05773601813319, 1.23219003347068, 1.08636328067921, 1.04298727706906, 1.04757871750622, 1.1258227373602, 1.07322445366976, 1.02206273703086, 1.11733915232859, 1.02776938623576, 0.987156332022299, 1.04387436800779, 0.84760621899685, 0.923891765935214, 0.878511285051736, 0.737899071430379, 0.734863339235946, 0.559604389846363, 0.49968426576712, 0.562494300341415, 0.56645426318583, 0.545536116755783, 0.283624539299512, 0.331457159578458, 0.243940113838301, 0.0663994370318747, 0.0842806610997205 ], "xaxis": "x1", "yaxis": "y1", "marker": { "line": { "width": 0.5 }, "size": 6, "color": "rgb(0,113.985,188.955)" }, "visible": true, "showlegend": true }, { "line": { "dash": "solid", "color": "rgb(216.75,82.875,24.99)", "width": 0.5 }, "mode": "lines", "name": "Filtered Data", "type": "scatter", "xsrc": "danton267:1353:9dff9e", "x": [ -3.14159265358979, -3.07812613533545, -3.01465961708111, -2.95119309882678, -2.88772658057244, -2.8242600623181, -2.76079354406376, -2.69732702580942, -2.63386050755508, -2.57039398930074, -2.5069274710464, -2.44346095279206, -2.37999443453772, -2.31652791628338, -2.25306139802904, -2.1895948797747, -2.12612836152037, -2.06266184326603, -1.99919532501169, -1.93572880675735, -1.87226228850301, -1.80879577024867, -1.74532925199433, -1.68186273373999, -1.61839621548565, -1.55492969723131, -1.49146317897697, -1.42799666072263, -1.36453014246829, -1.30106362421395, -1.23759710595962, -1.17413058770528, -1.11066406945094, -1.0471975511966, -0.983731032942258, -0.920264514687919, -0.85679799643358, -0.793331478179241, -0.729864959924901, -0.666398441670562, -0.602931923416223, -0.539465405161884, -0.475998886907544, -0.412532368653205, -0.349065850398866, -0.285599332144527, -0.222132813890187, -0.158666295635848, -0.0951997773815089, -0.0317332591271696, 0.0317332591271696, 0.0951997773815089, 0.158666295635848, 0.222132813890187, 0.285599332144527, 0.349065850398866, 0.412532368653205, 0.475998886907544, 0.539465405161884, 0.602931923416223, 0.666398441670562, 0.729864959924901, 0.793331478179241, 0.85679799643358, 0.920264514687919, 0.983731032942258, 1.0471975511966, 1.11066406945094, 1.17413058770528, 1.23759710595962, 1.30106362421395, 1.36453014246829, 1.42799666072263, 1.49146317897697, 1.55492969723131, 1.61839621548565, 1.68186273373999, 1.74532925199433, 1.80879577024867, 1.87226228850301, 1.93572880675735, 1.99919532501169, 2.06266184326603, 2.12612836152037, 2.1895948797747, 2.25306139802904, 2.31652791628338, 2.37999443453772, 2.44346095279206, 2.5069274710464, 2.57039398930074, 2.63386050755508, 2.69732702580942, 2.76079354406376, 2.8242600623181, 2.88772658057244, 2.95119309882678, 3.01465961708111, 3.07812613533545, 3.14159265358979 ], "ysrc": "danton267:1353:69ab83", "y": [ 0.0407361843196589, 0.073340997242127, 0.0543718473420524, 0.0621903912769214, 0.043578756151976, -0.0546870970574098, -0.147699490168591, -0.187345246726102, -0.244527796109349, -0.28579989771556, -0.338971160552883, -0.358591463213447, -0.390134011640137, -0.463419565487123, -0.518751098169879, -0.563871039921535, -0.632700178930847, -0.673046620476635, -0.692713093774196, -0.716352775093661, -0.71872531494594, -0.76244502282335, -0.786446211702289, -0.796198209613737, -0.823179968974073, -0.827074374648946, -0.79671197669709, -0.820559828787565, -0.83147839301727, -0.849850780244967, -0.841460820581062, -0.862125705298965, -0.84912537350971, -0.857035290000962, -0.834483574544713, -0.798765191892562, -0.732294459112577, -0.693625713775084, -0.608571900211095, -0.568824011564908, -0.542319289664841, -0.509568361402811, -0.436253966068113, -0.390837380431242, -0.327988285649681, -0.268371822438822, -0.206497063500554, -0.152412227251629, -0.095529082345092, -0.00507993650817267, 0.0469251956202442, 0.121704334645528, 0.185344142727996, 0.221079803162969, 0.251987451209669, 0.325162841924368, 0.400339804427974, 0.444649215713401, 0.524455388260031, 0.586761562560938, 0.6546344815061, 0.672569732375195, 0.731741828555436, 0.785846713695452, 0.864941674681297, 0.91822506665912, 0.972682368037976, 0.990975658178648, 0.996807466273831, 0.994985511989995, 1.01531126431394, 1.02322000525039, 1.07576855793032, 1.09538020245809, 1.13994263270311, 1.12241099432778, 1.12253385155005, 1.09337106537167, 1.10698840921707, 1.07519529325689, 1.06233518452722, 1.07720555957912, 1.07324369332503, 1.04551041225745, 1.03964039512506, 1.00474909151826, 0.966059614239583, 0.936207994002777, 0.886356541884393, 0.824554336130025, 0.766953970299928, 0.682112470266309, 0.618909073324245, 0.584620111675335, 0.546754667179302, 0.491558697069932, 0.4579132758322, 0.394202438531577, 0.294191473300786, 0.201940382169573 ], "xaxis": "x1", "yaxis": "y1", "marker": { "line": { "width": 0.5 }, "size": 6, "color": "rgb(216.75,82.875,24.99)" }, "visible": true, "showlegend": true } ], "layout": { "title": "<b><b></b></b>", "width": 840, "height": 630, "legend": { "x": 0.672023813195881, "y": 0.813888891159542, "font": { "size": 9, "color": "rgb(0,0,0_)", "family": "Arial, sans-serif" }, "xref": "paper", "yref": "paper", "bgcolor": "rgb(255,255,255)", "xanchor": "left", "yanchor": "bottom", "traceorder": "normal", "bordercolor": "rgb(38.25,38.25,38.25)", "borderwidth": 0.5 }, "margin": { "b": 0, "l": 0, "r": 0, "t": 0, "pad": 0 }, "scene1": { "domain": { "x": [ 0.13, 0.905 ], "y": [ 0.11, 0.925 ] } }, "xaxis1": { "side": "bottom", "type": "linear", "range": [ -4, 4 ], "ticks": "inside", "anchor": "y1", "domain": [ 0.13, 0.905 ], "mirror": "ticks", "nticks": 10, "ticklen": 6.51, "autotick": true, "showgrid": false, "showline": true, "tickfont": { "size": 10, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "zeroline": false, "autorange": false, "gridcolor": "rgb(38.25,38.25,38.25)", "gridwidth": 1, "linecolor": "rgb(38.25,38.25,38.25)", "linewidth": 1, "tickcolor": "rgb(38.25,38.25,38.25)", "tickwidth": 1, "titlefont": { "size": 11, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "exponentformat": "none" }, "yaxis1": { "side": "left", "type": "linear", "range": [ -1, 1.5 ], "ticks": "inside", "anchor": "x1", "domain": [ 0.11, 0.925 ], "mirror": "ticks", "nticks": 7, "ticklen": 6.51, "autotick": true, "showgrid": false, "showline": true, "tickfont": { "size": 10, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "zeroline": false, "autorange": false, "gridcolor": "rgb(38.25,38.25,38.25)", "gridwidth": 1, "linecolor": "rgb(38.25,38.25,38.25)", "linewidth": 1, "tickcolor": "rgb(38.25,38.25,38.25)", "tickwidth": 1, "titlefont": { "size": 11, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "exponentformat": "none" }, "autosize": false, "hovermode": "closest", "titlefont": { "color": "rgba(0,0,0,0)" }, "showlegend": true, "annotations": [ { "x": 0.5175, "y": 0.935, "font": { "size": 11, "color": "rgb(0,0,0)", "family": "Arial, sans-serif" }, "text": "<b><b></b></b>", "xref": "paper", "yref": "paper", "align": "center", "xanchor": "center", "yanchor": "bottom", "borderpad": 3, "showarrow": false, "textangle": 0, "bordercolor": "rgba(0,0,0,0)", "borderwidth": 0.5 } ], "paper_bgcolor": "rgb(255,255,255)" }, "frames": [] }
  {% endraw %}
{% endcapture %}
{% include posts/ssim_frame.html 
  raw_json_file=plot_0_0_moving_average_filter
  index=0
%}



<!--------------------- EXAMPLE BREAK ------------------------->

## Filter Matrix Rows

This example filters a matrix of data with the following rational transfer function.



<div class="code_responsive">

<span><span class="MathEquation" role="math" style="font-size: 15px;"><span class="MathRoot HBox" role="img" aria-label="H leftParenthesis z rightParenthesis equals StartFraction b leftParenthesis 1 rightParenthesis over a leftParenthesis 1 rightParenthesis plus a leftParenthesis 2 rightParenthesis z toThePowerOf minus 1 baseline EndFraction equals StartFraction 1 over 1 minus 0 ldotp 2 z toThePowerOf minus 1 baseline EndFraction" style="display: inline-block; position: relative;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.05em; margin-right: 0.1em;">H</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox text" style="position: relative;">z</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.277778em;">=</span><span class="MathFraction VBox" style="display: inline-block; position: relative; margin-left: 0.277778em; text-align: center; vertical-align: -12px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 0px;"><span class="MathText MathTextBox text" style="position: relative;">b</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">1</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="rulebox" style="display: block; border-bottom-style: solid; border-bottom-width: 1px; width: 100%; height: 0px; z-index: 1; margin-top: 0px;"></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 1px;"><span class="MathText MathTextBox text" style="position: relative;">a</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">1</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.222222em;">a</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">2</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathScript HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative;">z</span></span><span class="VBox" style="display: inline-block; position: relative; text-align: left; vertical-align: 5px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 10px; margin-top: 0px;"><span class="MathText MathTextBox symbol" style="position: relative;">−</span><span class="MathText MathTextBox number" style="position: relative;">1</span></span></span></span></span></span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.277778em;">=</span><span class="MathFraction VBox" style="display: inline-block; position: relative; margin-left: 0.277778em; text-align: center; vertical-align: -12px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 0px;"><span class="MathText MathTextBox number" style="position: relative;">1</span></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="rulebox" style="display: block; border-bottom-style: solid; border-bottom-width: 1px; width: 100%; height: 0px; z-index: 1; margin-top: 0px;"></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 1px;"><span class="MathText MathTextBox number" style="position: relative;">1</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">−</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.222222em;">0</span><span class="MathText MathTextBox symbol" style="position: relative;">.</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.166667em;">2</span><span class="MathScript HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative;">z</span></span><span class="VBox" style="display: inline-block; position: relative; text-align: left; vertical-align: 5px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 10px; margin-top: 0px;"><span class="MathText MathTextBox symbol" style="position: relative;">−</span><span class="MathText MathTextBox number" style="position: relative;">1</span></span></span></span></span></span></span></span></span></span>

</div>



Create a 2-by-15 matrix of random input data. 

<pre class="mcode">
rng default  %initialize random number generator
x = rand(2,15);
</pre>

Define the numerator and denominator coefficients for the rational transfer function.

<pre class="mcode">
b = 1;
a = [1 -0.2];
</pre>

Apply the transfer function along the second dimension of `x` and return the 1-D digital filter of each row. Plot the first row of original data against the filtered data.

<pre class="mcode">
y = filter(b,a,x,[],2);

t = 0:length(x)-1;  %index vector

plot(t,x(1,:))
hold on
plot(t,y(1,:))
legend('Input Data','Filtered Data')
title('First Row')

fig2plotly()
</pre>

{% capture plot_1_0_filter_matrix_rows %}
  {% raw %}
{ "data": [ { "line": { "dash": "solid", "color": "rgb(0,113.985,188.955)", "width": 0.5 }, "mode": "lines", "name": "Input Data", "type": "scatter", "xsrc": "danton267:1355:7578af", "x": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14 ], "ysrc": "danton267:1355:89fa46", "y": [ 0.814723686393179, 0.126986816293506, 0.63235924622541, 0.278498218867048, 0.957506835434298, 0.157613081677548, 0.957166948242946, 0.8002804688888, 0.421761282626275, 0.792207329559554, 0.655740699156587, 0.849129305868777, 0.678735154857773, 0.743132468124916, 0.655477890177557 ], "xaxis": "x1", "yaxis": "y1", "marker": { "line": { "width": 0.5 }, "size": 6, "color": "rgb(0,113.985,188.955)" }, "visible": true, "showlegend": true }, { "line": { "dash": "solid", "color": "rgb(216.75,82.875,24.99)", "width": 0.5 }, "mode": "lines", "name": "Filtered Data", "type": "scatter", "xsrc": "danton267:1355:7578af", "x": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14 ], "ysrc": "danton267:1355:6d9e53", "y": [ 0.814723686393179, 0.289931553572142, 0.690345556939838, 0.416567330255016, 1.0408203014853, 0.365777141974608, 1.03032237663787, 1.00634494421637, 0.62303027146955, 0.916813383853464, 0.83910337592728, 1.01694998105423, 0.88212515106862, 0.91955749833864, 0.839389389845285 ], "xaxis": "x1", "yaxis": "y1", "marker": { "line": { "width": 0.5 }, "size": 6, "color": "rgb(216.75,82.875,24.99)" }, "visible": true, "showlegend": true } ], "layout": { "title": "<b>First Row</b>", "width": 840, "height": 630, "legend": { "x": 0.672023813195881, "y": 0.813888910630393, "font": { "size": 9, "color": "rgb(0,0,0_)", "family": "Arial, sans-serif" }, "xref": "paper", "yref": "paper", "bgcolor": "rgb(255,255,255)", "xanchor": "left", "yanchor": "bottom", "traceorder": "normal", "bordercolor": "rgb(38.25,38.25,38.25)", "borderwidth": 0.5 }, "margin": { "b": 0, "l": 0, "r": 0, "t": 0, "pad": 0 }, "scene1": { "domain": { "x": [ 0.13, 0.905 ], "y": [ 0.11, 0.925 ] } }, "xaxis1": { "side": "bottom", "type": "linear", "range": [ 0, 14 ], "ticks": "inside", "anchor": "y1", "domain": [ 0.13, 0.905 ], "mirror": "ticks", "nticks": 9, "ticklen": 6.51, "autotick": true, "showgrid": false, "showline": true, "tickfont": { "size": 10, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "zeroline": false, "autorange": false, "gridcolor": "rgb(38.25,38.25,38.25)", "gridwidth": 1, "linecolor": "rgb(38.25,38.25,38.25)", "linewidth": 1, "tickcolor": "rgb(38.25,38.25,38.25)", "tickwidth": 1, "titlefont": { "size": 11, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "exponentformat": "none" }, "yaxis1": { "side": "left", "type": "linear", "range": [ 0.1, 1.1 ], "ticks": "inside", "anchor": "x1", "domain": [ 0.11, 0.925 ], "mirror": "ticks", "nticks": 12, "ticklen": 6.51, "autotick": true, "showgrid": false, "showline": true, "tickfont": { "size": 10, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "zeroline": false, "autorange": false, "gridcolor": "rgb(38.25,38.25,38.25)", "gridwidth": 1, "linecolor": "rgb(38.25,38.25,38.25)", "linewidth": 1, "tickcolor": "rgb(38.25,38.25,38.25)", "tickwidth": 1, "titlefont": { "size": 11, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "exponentformat": "none" }, "autosize": false, "hovermode": "closest", "titlefont": { "color": "rgba(0,0,0,0)" }, "showlegend": true, "annotations": [ { "x": 0.5175, "y": 0.935, "font": { "size": 11, "color": "rgb(0,0,0)", "family": "Arial, sans-serif" }, "text": "<b>First Row</b>", "xref": "paper", "yref": "paper", "align": "center", "xanchor": "center", "yanchor": "bottom", "borderpad": 3, "showarrow": false, "textangle": 0, "bordercolor": "rgba(0,0,0,0)", "borderwidth": 0.5 } ], "paper_bgcolor": "rgb(255,255,255)" }, "frames": [] }
  {% endraw %}
{% endcapture %}
{% include posts/ssim_frame.html 
  raw_json_file=plot_1_0_filter_matrix_rows
  index=1
%}

Plot the second row of input data against the filtered data.

<pre class="mcode">
figure
plot(t,x(2,:))
hold on
plot(t,y(2,:))
legend('Input Data','Filtered Data')
title('Second Row')

fig2plotly()
</pre>

{% capture plot_1_1_filter_matrix_rows %}
  {% raw %}
{ "data": [ { "line": { "dash": "solid", "color": "rgb(0,113.985,188.955)", "width": 0.5 }, "mode": "lines", "name": "Input Data", "type": "scatter", "xsrc": "danton267:1357:efae4e", "x": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14 ], "ysrc": "danton267:1357:622d3b", "y": [ 0.905791937075619, 0.913375856139019, 0.0975404049994095, 0.546881519204984, 0.964888535199277, 0.970592781760616, 0.485375648722841, 0.141886338627215, 0.915735525189067, 0.959492426392903, 0.0357116785741896, 0.933993247757551, 0.757740130578333, 0.392227019534168, 0.171186687811562 ], "xaxis": "x1", "yaxis": "y1", "marker": { "line": { "width": 0.5 }, "size": 6, "color": "rgb(0,113.985,188.955)" }, "visible": true, "showlegend": true }, { "line": { "dash": "solid", "color": "rgb(216.75,82.875,24.99)", "width": 0.5 }, "mode": "lines", "name": "Filtered Data", "type": "scatter", "xsrc": "danton267:1357:efae4e", "x": [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14 ], "ysrc": "danton267:1357:4a7738", "y": [ 0.905791937075619, 1.09453424355414, 0.316447253710238, 0.610170969947031, 1.08692272918868, 1.18797732759835, 0.722971114242512, 0.286480561475718, 0.973031637484211, 1.15409875388975, 0.266531429352139, 0.987299533627978, 0.955200037303929, 0.583267026994954, 0.287840093210553 ], "xaxis": "x1", "yaxis": "y1", "marker": { "line": { "width": 0.5 }, "size": 6, "color": "rgb(216.75,82.875,24.99)" }, "visible": true, "showlegend": true } ], "layout": { "title": "<b>Second Row</b>", "width": 840, "height": 630, "legend": { "x": 0.672023813195881, "y": 0.81388892361096, "font": { "size": 9, "color": "rgb(0,0,0_)", "family": "Arial, sans-serif" }, "xref": "paper", "yref": "paper", "bgcolor": "rgb(255,255,255)", "xanchor": "left", "yanchor": "bottom", "traceorder": "normal", "bordercolor": "rgb(38.25,38.25,38.25)", "borderwidth": 0.5 }, "margin": { "b": 0, "l": 0, "r": 0, "t": 0, "pad": 0 }, "scene1": { "domain": { "x": [ 0.13, 0.905 ], "y": [ 0.11, 0.925 ] } }, "xaxis1": { "side": "bottom", "type": "linear", "range": [ 0, 14 ], "ticks": "inside", "anchor": "y1", "domain": [ 0.13, 0.905 ], "mirror": "ticks", "nticks": 9, "ticklen": 6.51, "autotick": true, "showgrid": false, "showline": true, "tickfont": { "size": 10, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "zeroline": false, "autorange": false, "gridcolor": "rgb(38.25,38.25,38.25)", "gridwidth": 1, "linecolor": "rgb(38.25,38.25,38.25)", "linewidth": 1, "tickcolor": "rgb(38.25,38.25,38.25)", "tickwidth": 1, "titlefont": { "size": 11, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "exponentformat": "none" }, "yaxis1": { "side": "left", "type": "linear", "range": [ 0, 1.2 ], "ticks": "inside", "anchor": "x1", "domain": [ 0.11, 0.925 ], "mirror": "ticks", "nticks": 8, "ticklen": 6.51, "autotick": true, "showgrid": false, "showline": true, "tickfont": { "size": 10, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "zeroline": false, "autorange": false, "gridcolor": "rgb(38.25,38.25,38.25)", "gridwidth": 1, "linecolor": "rgb(38.25,38.25,38.25)", "linewidth": 1, "tickcolor": "rgb(38.25,38.25,38.25)", "tickwidth": 1, "titlefont": { "size": 11, "color": "rgb(38.25,38.25,38.25)", "family": "Arial, sans-serif" }, "exponentformat": "none" }, "autosize": false, "hovermode": "closest", "titlefont": { "color": "rgba(0,0,0,0)" }, "showlegend": true, "annotations": [ { "x": 0.5175, "y": 0.935, "font": { "size": 11, "color": "rgb(0,0,0)", "family": "Arial, sans-serif" }, "text": "<b>Second Row</b>", "xref": "paper", "yref": "paper", "align": "center", "xanchor": "center", "yanchor": "bottom", "borderpad": 3, "showarrow": false, "textangle": 0, "bordercolor": "rgba(0,0,0,0)", "borderwidth": 0.5 } ], "paper_bgcolor": "rgb(255,255,255)" }, "frames": [] }
  {% endraw %}
{% endcapture %}
{% include posts/ssim_frame.html 
  raw_json_file=plot_1_1_filter_matrix_rows
  index=1
%}



<!--------------------- EXAMPLE BREAK ------------------------->

## Filter Data in Sections

Use initial and final conditions for filter delays to filter data in sections, especially if memory limitations are a consideration.

Generate a large random data sequence and split it into two segments, `x1` and `x2`.

<pre class="mcode">
x = randn(10000,1);

x1 = x(1:5000);
x2 = x(5001:end);
</pre>

The whole sequence, `x`, is the vertical concatenation of `x1` and `x2`.

Define the numerator and denominator coefficients for the rational transfer function, 


<div class="code_responsive">

<span><span class="MathEquation" role="math" style="font-size: 15px;"><span class="MathRoot HBox" role="img" aria-label="H leftParenthesis z rightParenthesis equals StartFraction b leftParenthesis 1 rightParenthesis plus b leftParenthesis 2 rightParenthesis z toThePowerOf minus 1 baseline over a leftParenthesis 1 rightParenthesis plus a leftParenthesis 2 rightParenthesis z toThePowerOf minus 1 baseline EndFraction equals StartFraction 2 plus 3 z toThePowerOf minus 1 baseline over 1 plus 0 ldotp 2 z toThePowerOf minus 1 baseline EndFraction ldotp" style="display: inline-block; position: relative;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.05em; margin-right: 0.1em;">H</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox text" style="position: relative;">z</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.277778em;">=</span><span class="MathFraction VBox" style="display: inline-block; position: relative; margin-left: 0.277778em; text-align: center; vertical-align: -12px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 0px;"><span class="MathText MathTextBox text" style="position: relative;">b</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">1</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.222222em;">b</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">2</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathScript HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative;">z</span></span><span class="VBox" style="display: inline-block; position: relative; text-align: left; vertical-align: 5px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 10px; margin-top: 0px;"><span class="MathText MathTextBox symbol" style="position: relative;">−</span><span class="MathText MathTextBox number" style="position: relative;">1</span></span></span></span></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="rulebox" style="display: block; border-bottom-style: solid; border-bottom-width: 1px; width: 100%; height: 0px; z-index: 1; margin-top: 0px;"></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 1px;"><span class="MathText MathTextBox text" style="position: relative;">a</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">1</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox text" style="position: relative; margin-left: 0.222222em;">a</span><span class="MathText MathTextBox extra1" style="position: relative;">(</span><span class="MathText MathTextBox number" style="position: relative;">2</span><span class="MathText MathTextBox extra1" style="position: relative;">)</span><span class="MathScript HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative;">z</span></span><span class="VBox" style="display: inline-block; position: relative; text-align: left; vertical-align: 5px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 10px; margin-top: 0px;"><span class="MathText MathTextBox symbol" style="position: relative;">−</span><span class="MathText MathTextBox number" style="position: relative;">1</span></span></span></span></span></span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.277778em;">=</span><span class="MathFraction VBox" style="display: inline-block; position: relative; margin-left: 0.277778em; text-align: center; vertical-align: -12px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 0px;"><span class="MathText MathTextBox number" style="position: relative;">2</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.222222em;">3</span><span class="MathScript HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative;">z</span></span><span class="VBox" style="display: inline-block; position: relative; text-align: left; vertical-align: 5px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 10px; margin-top: 0px;"><span class="MathText MathTextBox symbol" style="position: relative;">−</span><span class="MathText MathTextBox number" style="position: relative;">1</span></span></span></span></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="rulebox" style="display: block; border-bottom-style: solid; border-bottom-width: 1px; width: 100%; height: 0px; z-index: 1; margin-top: 0px;"></span><span class="WhiteSpaceBox" style="display: none;"></span><span class="MathRow HBox" style="display: block; position: relative; font-size: 15px; margin-top: 1px;"><span class="MathText MathTextBox number" style="position: relative;">1</span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.222222em;">+</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.222222em;">0</span><span class="MathText MathTextBox symbol" style="position: relative;">.</span><span class="MathText MathTextBox number" style="position: relative; margin-left: 0.166667em;">2</span><span class="MathScript HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathRow HBox" style="display: inline-block; position: relative; font-size: 15px;"><span class="MathText MathTextBox text" style="position: relative;">z</span></span><span class="VBox" style="display: inline-block; position: relative; text-align: left; vertical-align: 5px;"><span class="MathRow HBox" style="display: block; position: relative; font-size: 10px; margin-top: 0px;"><span class="MathText MathTextBox symbol" style="position: relative;">−</span><span class="MathText MathTextBox number" style="position: relative;">1</span></span></span></span></span></span><span class="MathText MathTextBox symbol" style="position: relative; margin-left: 0.166667em;">.</span></span></span></span></span>

</div>



<pre class="mcode">
b = [2,3];
a = [1,0.2];
</pre>

Filter the subsequences `x1` and `x2` one at a time. Output the final conditions from filtering `x1` to store the internal status of the filter at the end of the first segment.

<pre class="mcode">
[y1,zf] = filter(b,a,x1);
</pre>

Use the final conditions from filtering `x1` as initial conditions to filter the second segment, `x2`.

<pre class="mcode">
y2 = filter(b,a,x2,zf);
</pre>

`y1` is the filtered data from `x1`, and `y2` is the filtered data from `x2`. The entire filtered sequence is the vertical concatenation of `y1` and `y2`.

Filter the entire sequence simultaneously for comparison.

<pre class="mcode">
y = filter(b,a,x);

isequal(y,[y1;y2])
</pre>


<pre class="codeoutput">ans = <span class="emphasis"><em>logical</em></span>
   1

</pre>




<!--------------------- EXAMPLE BREAK ------------------------->

